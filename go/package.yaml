name: go
description: The Go programming language
repo: golang/go
version:
  latest: go1.15.5 # renovate: datasource=github-tags depName=golang/go versioning=regex:^go(?<major>\d+)\.(?<minor>\d+)\.(?<patch>\d+)$
  command: go version
  filter: ^go
  pattern: s/^go\sversion\s(\S+)\s.+$/\1/
tags:
  - go
files:
  - name: profile.d.go.sh
    content: |
      #!/bin/bash
      export PATH="${TARGET_BASE}/gvm/gos/${GO_VERSION}/bin:${PATH}"
install:
  script: |-
    require gvm

    ${SUDO} bash -c "source /etc/profile.d/gvm.sh; gvm install \"${TAG}\" --binary"

    get_file go profile.d.go.sh | \
        TARGET_BASE="${TARGET_BASE}" GO_VERSION="${requested_version}" envsubst '${TARGET_BASE},${GO_VERSION}' | \
        store_file go.sh /etc/profile.d
